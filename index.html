<HTML>
<HEAD>
<TITLE>Negroponte</TITLE>
<STYLE>
tr td:last-child{
    white-space:nowrap;
}

textarea, .in {
	border: 1px;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
    resize:none;
    background:#000000;
    overflow-wrap:normal;
    font-family:'Courier New', Courier, monospace;
    color:yellow;
    display:block;
}

.white {
    color:#FFFFFF;
}
</STYLE>
</HEAD>
<BODY bgcolor=#000000>

<CENTER>
<H1 class="white">Negroponte</H1>

<TABLE class="white" border="1">
    <TR>
        <TD valign="top">
            <TEXTAREA id="bfasm" rows="30" cols="80" spellcheck="false"></TEXTAREA>
            <input id="memory" style="width: 100%;" class="in" spellcheck="false" style="border-top: 3px solid white;" readonly>
            <input id="code" style="width: 100%;" class="in" spellcheck="false" style="border-top: 3px solid white;" readonly>
        </TD>
        
        <TD valign="top" rowspan="2">
            <TEXTAREA id="stats" cols="25" rows="2" spellcheck="false" readonly></TEXTAREA>
            <TEXTAREA id="regs" cols="25" rows="4" spellcheck="false" readonly></TEXTAREA>
            <TEXTAREA id="stack" cols="25" rows="10" spellcheck="false" readonly></TEXTAREA>
            <TEXTAREA id="misc" cols="25" rows="3" style="" spellcheck="false" readonly></TEXTAREA>
            
            <div><input type="checkbox" id="chkbxRunning" onClick="chkRun();"> Run / Continue</div>
            <div><input type="checkbox" id="chkbxDebug" onClick="chkDebug();"> Debugging mode</div>
            <div><input type="checkbox" id="chkbxBfBrkpoints" onClick="chkBfBrk();"> Brainfuck breakpoints</div>
            <div><input type="checkbox" id="chkbxAsmBrkpoints" onClick="chkAsBrk();"> Assembly breakpoints</div>
            <div><input type="checkbox" id="chkbxLimitSpeed" onClick="chkLim();"> Limit execution speed</div>
            <div><input type="checkbox" id="chkbxSwitch" onClick="chkSwi();"> Switch between code and output</div>
            <div><input type="checkbox" id="chkbxReset" onClick="reset();"> Reset</div>
            
            <HR>
            
            <FONT size=2>
                <CENTER><I>Copyright (C) Jan 2019<BR>by Krzysztof Palaiologos Szewczyk</I></CENTER>
            </FONT>
        </TD>
    </TR>
    <TR>
        <TD>
            <input id="input" style="width: 100%;" class="in" onkeypress="inKprs(event);">
        </TD>
    </TR>
</TABLE>

</CENTER>

<SCRIPT>

var code;
var output;
var powerSaving = false;
var assemblyBreakpoints = false;
var brainfuckBreakpoints = false;
var debug = false;

var inputBuffer = [];

$ = function(x) {
    return document.getElementById(x);
}

reset = function() {
    $('stats').value = "Assembly: 0 bytes\nBrainfuck: 0 bytes\nCompressed: 0 bytes";
    $('regs').value = "R1: 0\nR2: 0\nR3: 0\nR4: 0\nPC: 0";
    $('stack').value = "SP: 0\n[]";
    $('misc').value = "kIPS: 0\nState: HALT\nBuffer Queue: 0";
    $('memory').value = "[>0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]";
    $('code').value = "['                                                                               ]";
    $('chkbxReset').checked = false;
    $('chkbxSwitch').checked = false;
    $('chkbxLimitSpeed').checked = false;
    $('chkbxAsmBrkpoints').checked = false;
    $('chkbxBfBrkpoints').checked = false;
    $('chkbxDebug').checked = false;
    $('chkbxRunning').checked = false;
    $('bfasm').readOnly = false;
    $('bfasm').value = '';
    
    powerSaving = false;
    assemblyBreakpoints = false;
    brainfuckBreakpoints = false;
    debug = false;
    inputBuffer = [];
    code = '';
    output = '';
}

function chkRun() {
    var bf = compile($('bfasm').value);
}

function chkDebug() {
    debug = !debug;
}

function chkBfBrk() {
    brainfuckBreakpoints = true;
}

function chkAsBrk() {
    assemblyBreakpoints = true;
}

function chkLim() {
    powerSaving = !powerSaving;
}

function chkSwi() {
    if(bfasm.readOnly) {
        bfasm.readOnly = false;
        bfasm.value = code;
    } else {
        code = bfasm.value;
        bfasm.readOnly = true;
        bfasm.value = output;
    }
    
    $('chkbxSwitch').checked = false;
}

function chkCompile() {
    var url = 'data:application/octet-stream,' + urlencode(compile($('bfasm').value));
    var anchor = document.createElement('a');
        anchor.setAttribute('href', url);
        anchor.setAttribute('download', 'output.b');
    $(anchor)[0].click();
    var ev = document.createEvent("MouseEvents");
        ev.initMouseEvent("click", true, false, self, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
    anchor.dispatchEvent(ev);

}

function inKprs(c) {
    if(c.charCode != 0)
        inputBuffer.push(c.key);
    if(c.key == "Enter")
        $("input").value="";
}

reset();

</SCRIPT>

</BODY>
</HTML>
